# Sources:
# http://www.robo47.net/blog/208-Git-Aliases-Submodules-and-Symfony
# http://nerderati.com/2010/07/making-git-behave/

[user]
	name = Sebastian Tramp
	email = mail@sebastian.tramp.name
    signingkey = 2ED13866

[alias]
## shortcuts
    a        = add
    aa       = add .           # add all
    au       = add --update :/ # add all modified files which are already tracked
    b        = branch
    ba       = branch -a
    c        = commit -S
    cp       = commit
    cl       = clone
    co       = checkout
    ci       = checkout-index
    coi      = checkout-index
    ce       = config --edit
    ceg      = config --edit --global
    d        = diff
    dc       = diff --cached
    dt       = difftool
    dtc      = difftool --cached
    f        = fetch --prune --all
    ff       = "!git f && git smf" # fetch current and all subdirectories
    p        = pull
    pp       = "!git p && git smp" # pull current and all subdirectories
    s        = status -sb
    st       = status
    staged   = diff --cached        # what is already in the index
    t        = tag
    unchange = checkout-index -a -f # drop changes but keep the index / staged changes
    unstage  = reset HEAD           # unadd everything / drop index but keep changes
    unstash  = stash apply
    # jump command shortcuts
    jm       = jump merge
    jd       = jump diff
    jdc      = jump diff --cached
    jg       = jump grep -Ri

## log stuff
    l           = "!git --no-pager log -1 --format=format:\"$path: %Cgreen%s%Creset (%Cred$(git rev-parse --abbrev-ref HEAD)%Creset/%ar)\"; echo "
    x           = log -10 --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'
    xlog        = log -10 --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'
    xlogall     = log -10 --branches --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'
    xlogfull    = log --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'
    xlogfullall = log --branches --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'
    glog        = log --oneline --decorate --stat --graph
    tree        = log --decorate --pretty=oneline --abbrev-commit --graph
    lc          = log ORIG_HEAD.. --stat --no-merges --graph

## investigating
    # from phil: show jenkins notes
    jenkins=notes --ref jenkins show
    # meld diff between branches and much more
    # git://github.com/wmanley/git-meld.git
    meld="!~/.local/bin/git-meld.pl"
    # shows ignored directories
    ignored   = "!git ls-files --others -i --exclude-standard --directory"
    # show users which have commits in current branch
    userlist  = "!git log --format='%aN' | sort -u"
    # same as userlist but with commit count
    usercount = "!git log --format='%aN <%aE>'  | awk '{arr[$0]++} END{for (i in arr){print arr[i], i;}}' | sort -nr"
    # equivalent to hg out (somehow)
    # http://stackoverflow.com/questions/1450348/
    remote-branch = "!echo $(git config branch.$(git rev-parse --abbrev-ref HEAD).remote)/$(git config branch.$(git rev-parse --abbrev-ref HEAD).merge | cut -d "/" -f 3-)"
    out = "!git --no-pager log $(git remote-branch)..HEAD --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'; echo ''"
    in = "!git --no-pager log HEAD..$(git remote-branch) --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by %an)%Creset'"

    # should be some day similar to "hg info"
    info = remote show origin

## submodule stuff
    sm = submodule
    # submodule foreach - shortcut when running something on all submodules
    # r = recursive, q = quiet
    smfe   = submodule foreach
    smfeq  = submodule foreach --quiet
    smfer  = submodule foreach --recursive
    smferq = submodule foreach --recursive --quiet
    # submodule last message
    # --format=format:'%Cgreen%h%Creset %Cred%d%Creset %s %Cblue(%ar by
    # %an)%Creset)
    sml  = "!git l; git --paginate smferq 'git --no-pager log -1 --format=format:\"$path: %Cgreen%s%Creset (%Cred$(git rev-parse --abbrev-ref HEAD)%Creset/%ar)\"; echo '"
    # submodule branches
    smb   = "!git smfeq  'echo \"$(git rev-parse --abbrev-ref HEAD) -> $path\"'"
    smbr  = "!git smferq 'echo \"$(git rev-parse --abbrev-ref HEAD) -> $path\"'"
    # submodule init update - runs initialisation and update recursive
    smiu  = "!git sm init; git sm update; git smfe 'git smiu'"
    # submodule status
    sms   = "!git smferq git status --porcelain"
    smst  = "!git smferq git status"
    # submodule update
    smp   = "!git smfer 'git --no-pager pull || echo failed' "
    smf   = "!git smfer git --no-pager fetch --prune --all"

# merging
    m-noff = merge --no-ff    # no fast forward merge
    m-ff   = merge --ff-only  #    fast formard merge
    addTo  = "!/home/seebi/bin/scripts/gitAddFile.sh $1 $2"

# other stuff
    clean-all = clean -dfq

[color]
    diff        = always
    status      = always
    branch      = always
    interactive = always
    ui          = always
    pager       = true

[color "branch"]
    current = yellow reverse
    local   = yellow
    remote  = green

[color "diff"]
    meta = yellow bold
    frag = magenta bold
    old  = red bold
    new  = green bold

[color "status"]
    added     = yellow
    changed   = green
    untracked = cyan

[core]
    pager      = less -FRSX
    whitespace = fix,-indent-with-non-tab,trailing-space,cr-at-eol

# git flow default configuration
[gitflow "branch"]
    master = master
    develop = develop
[gitflow "prefix"]
    feature = feature/
    release = release/
    hotfix = hotfix/
    support = support/
    versiontag = v

[diff]
    #external = ~/.local/scripts/gitOpendiff.sh
	tool = Kaleidoscope

#http://stackoverflow.com/questions/8156493/git-vimdiff-and-dirdiff
[difftool "default-difftool"]
    cmd = vim -f '+next' '+execute \"DirDiff\" argv(0) argv(1)' $LOCAL $REMOTE

[difftool]
	prompt = false

[merge]
	tool = Kaleidoscope

[interactive]
    singlekey = true
[github]
    user = seebi
[web]
    browser = chromium
[rerere]
    enabled = 1

#[remote "origin"]
    #fetch = +refs/notes/*:refs/notes/*

[push]
	default = simple
[remote-hg]
	hg-git-compat = true
[mergetool]
	keepBackup = true
	prompt = false
[difftool "Kaleidoscope"]
	cmd = ksdiff --partial-changeset --relative-path \"$MERGED\" -- \"$LOCAL\" \"$REMOTE\"
[mergetool "Kaleidoscope"]
	cmd = ksdiff --merge --output \"$MERGED\" --base \"$BASE\" -- \"$LOCAL\" --snapshot \"$REMOTE\" --snapshot
	trustExitCode = true
